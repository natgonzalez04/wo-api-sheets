<!DOCTYPE html>
<html>
    <head>
    <base target="_top">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
    </head>
    <body>

            <section class="containerCatalogoBase">
                <section class="titleCatalogo">
                    <span>Ingresa el numero de id del tercero que quieres consultar su dirección</span>
                </section>
                <section class="observacionesInfo">
                    <h4>Para tener en cuenta</h4>
                    <ul>
                        <li>
                            Tu registro sera agregado apartir de la celda activa seleccionada con sus respectivas columnas a derecha.
                        </li>
                        <li>
                            Puedes seleccionar si deseas incluir los encabezados de las columnas asignadas a los campos listados. 
                        </li>
                    </ul>
                </section>

                <section class="optionAll">
                    <span style="margin-right: 5px;">Incluir encabezados</span>
                    <label class="switch">
                        <input type="checkbox" id="addEncabezado" checked>
                        <span class="slider"></span>
                    </label>
                </section>

                <section class="containerConsultaTercero">
                    <div style="display: inline-flex; margin-left: -3vw;">
                        <div style="display: inline-flex; margin-left: 40px;">
                            <label for="idTercero">Id:
                            <input type="number" name="idTercero" id="idTercero" min="0" placeholder="# id">
                            </label>
                        </div>
                    </div>
                    <div class="mensajeErrorConsulta">
                        <span>Por favor, completa el campo para continuar</span>
                    </div>
                </section>

                <section class="containerEjemplo">
                    <span>Ejemplo:</span>


                </section>

                <button type="button" class="buttonImport" onclick="sendDataSelected()">Agregar</button>
                
            </section>

            <div id="loading" class="loading" style="display:none;">
                <div class="d-flex justify-content-center align-items-end">
                        <div class="spinner-grow" style="width: 1rem; height: 1rem" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>   
                        <div class="spinner-grow " style="width: 2rem; height: 2em" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>   
                        <div class="spinner-grow" style="width: 3rem; height: 3rem" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>   
                </div>
                <p style=" margin-top: 3vh; font-weight: 600; color: #0d95f0;">Cargando datos</p>
            </div>
        
            <script>

                    var contenedorGlobal = document.querySelector('.containerCatalogoBase');
                    var contenedorLoading = document.querySelector('.loading');
                    var statusCheck;
                    contenedorGlobal.style.display = 'flex';

                    var encabezados = [ 'Dirección', 'Ciudad', 'Telefono principal', 'Email principal', 'Nombre de dirección o sucursal', 'Principal'];
                    var datos = ['Cl 12 21 85', 'Bogota DC', '3021458796', 'admon@miempresa.com', 'Principal','Si'];

                
                    var tabla = document.createElement('table');

                
                    var thead = document.createElement('thead');
                    var tr = document.createElement('tr');
                    for (var i = 0; i < encabezados.length; i++) {
                        var th = document.createElement('th');
                        th.textContent = encabezados[i];
                        th.classList.add('formatoTabla');
                        tr.appendChild(th);
                    }
                    thead.appendChild(tr);
                    tabla.appendChild(thead);

                    
                    var tbody = document.createElement('tbody');
                    tr = document.createElement('tr');
                    for (var i = 0; i < datos.length; i++) {
                        var td = document.createElement('td');
                        td.textContent = datos[i];
                        td.classList.add('formatoTablaContenido');
                        tr.appendChild(td);
                    }
                    tbody.appendChild(tr);
                    tabla.appendChild(tbody);

            
                    var seccion = document.querySelector('.containerEjemplo');
                    seccion.appendChild(tabla);

                    function guardarSeleccion() {
                        var identificacion = document.getElementById('identificacion');
                        var idTercero = document.getElementById('idTercero');
                        var mensajeError = document.querySelector('.mensajeErrorConsulta');
                        var checkboxEncabezados = document.getElementById('addEncabezado').checked;

                        checkboxEncabezados.onchange = guardarSeleccion;
                        
                        if(idTercero.value) {
                            mensajeError.style.display = 'none';
                            var seleccionTercero = {
                                idTercero: idTercero.value,
                                importarEncabezados: checkboxEncabezados
                            };
                            console.log(seleccionTercero.importarEncabezados,'seleccionTercero');
                            google.script.run.guardarSeleccionTerceroDireccion(seleccionTercero);
                            return true;
                        }else{
                            mensajeError.style.display = 'block';
                            return false;
                        }


                    }
                    
                    
                    identificacion.onchange = guardarSeleccion;
                    idTercero.onchange = guardarSeleccion;
                    

                    function sendDataSelected() {
                        var validacionCampos = guardarSeleccion();
                        if (validacionCampos) {
                            contenedorGlobal.style.display = 'none';
                            contenedorLoading.style.display = 'flex';
                            google.script.run.withSuccessHandler(function(result) {
                                google.script.host.close();
                            }).withFailureHandler(function(error) {
                                google.script.host.close();
                            }).mostrarDatosConsultaTerceroDireccion();
                        }
                    
                    }

            </script>
    </body>
</html>